<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>iOS 基础(1)- Property 修饰符 | 莫十七</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">iOS 基础(1)- Property 修饰符</h1><a id="logo" href="/.">莫十七</a><p class="description">一样生，百样活</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">iOS 基础(1)- Property 修饰符</h1><div class="post-meta">Aug 15, 2017<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><h3 id="1-atomic-amp-nonatomic"><a href="#1-atomic-amp-nonatomic" class="headerlink" title="1.atomic &amp; nonatomic"></a>1.atomic &amp; nonatomic</h3><p><strong>多线程相关</strong>，指定属性的读取操作是否为原子操作，即是否线程安全。<br><code>atomic</code>为默认选项，表示线程安全，至少在当前的存取器上是安全的，意味着同一时间只能有一个线程访问实例变量。线程安全涉及到加锁机制，会消耗大量资源损耗性能，所以效率会比较低。</p>
<p><code>nonatomic</code>表示非线程安全，修饰的实例变量可以同时被多个线程访问。跟<code>atomic</code>相比，效率比较高，可以提高访问性能。适合内存比较小的移动设备。</p>
<h3 id="2-readwrite-amp-readonly"><a href="#2-readwrite-amp-readonly" class="headerlink" title="2. readwrite &amp; readonly"></a>2. readwrite &amp; readonly</h3><p><strong>存取器控制</strong>，<br><code>readwrite</code>：<strong>默认选项</strong>，表示属性同时拥有同时拥有<code>setter</code>方法和<code>getter</code>方法。<br><code>readonly</code>：表示属性只拥有<code>getter</code>方法，没有<code>setter</code>方法。</p>
<h3 id="3-strong-amp-weak"><a href="#3-strong-amp-weak" class="headerlink" title="3. strong &amp; weak"></a>3. strong &amp; weak</h3><p>在 ARC 下用于属性的内存管理，用来修饰对象，不能用来修饰基本的值数据类型，如<code>int</code>，<code>float</code>等。</p>
<p><code>strong</code>：表示一种拥有关系，属性和所赋的值之间是强引用关系。赋值时，先保留新值，增加新值的引用计数，然后再释放旧值减少旧值的引用计数。<code>strong</code>用来修饰对象，不用修饰基本的值数据类型。</p>
<p><code>weak</code>表示一种非拥有关系，属性和所赋的值之间是弱引用的关系。赋值时，不会增加新值的引用计数，也不减少旧值的引用计数。<code>weak</code>声明的属性在引用计数减少为 0 被释放后，会自动设置为 nil，避免野指针的错误。<br><code>weak</code>常被用在<code>delegate</code>等容易出现循环引用的场景。</p>
<h3 id="4-retain"><a href="#4-retain" class="headerlink" title="4. retain"></a>4. retain</h3><p>在 MRC 下用于属性的内存管理，和<code>strong</code>的用法一致。</p>
<h3 id="5-assign"><a href="#5-assign" class="headerlink" title="5. assign"></a>5. assign</h3><p><code>assign</code>表示单纯的复制（值复制），赋值时，不会更改新值和旧值的引用计数。用于值类型，如<code>int</code>,<code>float</code>,<code>double</code>和<code>NSInteger</code>，<code>CGFloat</code>等，还包括不存在所有权关系的对象，如常见的<code>delegate</code>。</p>
<p><code>assign</code>也可以用来修饰对象，如<code>NSString</code>等类型对象，由于在赋值过程中没有改变新值以及旧值的引用计数，所以当新值的引用计数为 0 时，编译器不会将该属性置为<code>nil</code>，指针还会指向之前被销毁的内存，这时访问该属性会产生野指针错误并崩溃，因此使用<code>assign</code>修饰的类型一定要为值类型。</p>
<h3 id="6-copy"><a href="#6-copy" class="headerlink" title="6. copy"></a>6. copy</h3><p><code>copy</code>修饰的对象，与<code>strong</code>相同，都是强引用关系，不同的是，赋值时<code>copy</code>修饰的属性不会保留新值，而是将新值在内存中拷贝了一份。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">@interface ViewController ()</div><div class="line"></div><div class="line">@property (nonatomic, copy) NSString *str;</div><div class="line"></div><div class="line">@end</div><div class="line">@implementation ViewController</div><div class="line"></div><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">    </div><div class="line">    NSString *str2 = @&quot;I&apos;m A&quot;;</div><div class="line">    self.str = str2;</div><div class="line">    str2 = @&quot;I&apos;m B&quot;;</div><div class="line">    [str2 valueForKey:@&quot;retainCount&quot;];</div><div class="line">    OBJC_EXTERN int _objc_rootRetainCount(id);</div><div class="line">    </div><div class="line">    NSLog(@&quot;result:str:%@, str2:%@, str2 retainCount:%d&quot;, self.str, str2, _objc_rootRetainCount(str2));</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>打印结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">result:str:I&apos;m A, str2:I&apos;m B, str2 retainCount:1</div></pre></td></tr></table></figure>
<p>如以上代码所示：</p>
<ol>
<li>str2 的值改变时，不会影响属性 str，可见<code>self.str = str2</code>赋值语句只是将 str2 值的副本赋给了属性 str，两者指针不同。</li>
<li>str2 的引用计数为1，可见赋值语句没有改变 str2 的引用计数。</li>
</ol>
<p>因为<code>NSString</code>、<code>NSArray</code>、<code>NSDictionary</code>有对应的可变类型<code>NSMutableString</code>、<code>NSMutableArray</code>、<code>NSMutableDictionary</code>，为了确保对象不会在无意间发生变动，这些对象多使用<code>copy</code>关键字。</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yoursite.com/2017/08/15/iosBase-1-property/" data-id="cj6ddnjx80003wkfer4ghmy7m" class="article-share-link">分享到</a><div class="tags"></div><div class="post-nav"><a href="/2017/08/12/git-order/" class="next">Git 的基本命令</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/08/15/iosBase-1-property/">iOS 基础(1)- Property 修饰符</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/12/git-order/">Git 的基本命令</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/26/UIViewAnimation/">iOS 动画篇： UIView Animation</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/18/SetupBlog/">使用 Hexo 和 Github Pages 搭建博客</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">莫十七.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>